<svg width="520" height="400" viewBox="0 0 420 320" xmlns="http://www.w3.org/2000/svg">
  <defs>
    <marker id="arrow" markerWidth="8" markerHeight="8" refX="6" refY="4" orient="auto">
      <path d="M0,0 L8,4 L0,8 Z" fill="#A855F7"/>
    </marker>
    <marker id="arrow-start" markerWidth="8" markerHeight="8" refX="2" refY="4" orient="auto">
      <path d="M8,0 L0,4 L8,8 Z" fill="#A855F7"/>
    </marker>
    <marker id="arrow-gray" markerWidth="8" markerHeight="8" refX="6" refY="4" orient="auto">
      <path d="M0,0 L8,4 L0,8 Z" fill="#666"/>
    </marker>
  </defs>

  <!-- AZTEC Layer -->
  <rect x="20" y="20" width="380" height="100" rx="4" fill="#0a0a0a" stroke="#333" stroke-width="1"/>
  <text x="35" y="45" fill="#fff" font-family="system-ui, sans-serif" font-size="13" font-weight="600">AZTEC</text>
  <text x="90" y="45" fill="#666" font-family="system-ui, sans-serif" font-size="10">encrypted</text>

  <!-- Private Balance -->
  <rect x="35" y="65" width="140" height="40" rx="3" fill="#111" stroke="#333" stroke-width="1"/>
  <text x="105" y="90" fill="#ccc" font-family="monospace" font-size="11" text-anchor="middle">Private Balance</text>

  <!-- Train on Aztec -->
  <rect x="255" y="65" width="125" height="40" rx="3" fill="#111" stroke="#A855F7" stroke-width="1"/>
  <text x="317" y="90" fill="#A855F7" font-family="monospace" font-size="11" text-anchor="middle">Train HTLC</text>

  <!-- Arrow from balance to train -->
  <line x1="175" y1="85" x2="250" y2="85" stroke="#666" stroke-width="1.5" marker-end="url(#arrow-gray)"/>

  <!-- BASE Layer -->
  <rect x="20" y="140" width="380" height="160" rx="4" fill="#0a0a0a" stroke="#333" stroke-width="1"/>
  <text x="35" y="165" fill="#fff" font-family="system-ui, sans-serif" font-size="13" font-weight="600">BASE</text>
  <text x="75" y="165" fill="#666" font-family="system-ui, sans-serif" font-size="10">public</text>

  <!-- Fresh Address -->
  <rect x="35" y="190" width="140" height="40" rx="3" fill="#111" stroke="#333" stroke-width="1"/>
  <text x="105" y="215" fill="#ccc" font-family="monospace" font-size="11" text-anchor="middle">Fresh Address</text>

  <!-- Train on Base -->
  <rect x="255" y="190" width="125" height="40" rx="3" fill="#111" stroke="#A855F7" stroke-width="1"/>
  <text x="317" y="215" fill="#A855F7" font-family="monospace" font-size="11" text-anchor="middle">Train HTLC</text>

  <!-- Arrow from train to fresh -->
  <line x1="250" y1="210" x2="175" y2="210" stroke="#666" stroke-width="1.5" marker-end="url(#arrow-gray)"/>

  <!-- zkp2p inside BASE -->
  <rect x="35" y="250" width="120" height="35" rx="3" fill="#111" stroke="#4ADE80" stroke-width="1"/>
  <text x="95" y="273" fill="#4ADE80" font-family="monospace" font-size="12" text-anchor="middle">zkp2p</text>

  <!-- Arrow to zkp2p -->
  <line x1="105" y1="230" x2="105" y2="245" stroke="#666" stroke-width="1.5" marker-end="url(#arrow-gray)"/>

  <!-- Double arrow between Train contracts with solver label -->
  <line x1="317" y1="110" x2="317" y2="185" stroke="#A855F7" stroke-width="2" marker-start="url(#arrow-start)" marker-end="url(#arrow)"/>
  <text x="340" y="150" fill="#A855F7" font-family="system-ui, sans-serif" font-size="10">solvers</text>

  <!-- Dashed border around Train section - ON TOP -->
  <rect x="245" y="55" width="145" height="190" rx="6" fill="none" stroke="#A855F7" stroke-width="1.5" stroke-dasharray="6,4"/>
  <text x="317" y="260" fill="#A855F7" font-family="system-ui, sans-serif" font-size="10" text-anchor="middle" opacity="0.8">Train Protocol</text>
</svg>
